{"apiVersion": "batch.volcano.sh/v1alpha1", "kind": "Job", "metadata": {"name": "hpccfft"}, "spec": {"schedulerName": "volcano", "plugins": {"ssh": [], "svc": []}, "tasks": [{"replicas": 1, "name": "mpimaster", "policies": [{"event": "TaskCompleted", "action": "CompleteJob"}], "template": {"spec": {"containers": [{"command": ["/bin/sh", "-c", "MPI_HOST=\"/etc/volcano/mpi/HOSTFILE\";\necho `cat ${MPI_HOST}`\nmkdir -p /var/run/sshd; /usr/sbin/sshd;\ncp /opt/results/hpccinf.txt /home;\nsleep 60;\nmpirun --allow-run-as-root --hostfile ${MPI_HOST} --nooversubscribe --mca mpi_yield_when_idle 0 --mca btl ^openib,uct --mca pml ucx --display-devel-map --display-allocation --report-bindings -np 16  /opt/HPCC1.5.0-MPI/bin/hpccfft > hpccfft-2.log 2>&1;\nmv hpccoutf.txt hpccfft-2.out;\n"], "image": "mpinetworktrace", "name": "mpimaster", "ports": [{"containerPort": 22, "name": "mpijob-port"}], "workingDir": "/home", "imagePullPolicy": "IfNotPresent"}], "restartPolicy": "OnFailure"}}}, {"replicas": 1, "name": "mpiworker", "template": {"spec": {"containers": [{"command": ["/bin/sh", "-c", "cp /opt/results/hpccinf.txt /home;\nmkdir -p /var/run/sshd; /usr/sbin/sshd -D;\n"], "image": "mpinetworktrace", "name": "mpiworker", "ports": [{"containerPort": 22, "name": "mpijob-port"}], "workingDir": "/home", "imagePullPolicy": "IfNotPresent", "resources": {"requests": {"cpu": 8, "memory": "40Gi"}, "limits": {"cpu": 8, "memory": "40Gi"}}}], "restartPolicy": "OnFailure"}}}], "volumes": [{"mountPath": "/home", "volumeClaimName": "hpccfft"}]}}